// Modal Component - BEM Structure
// Reusable modal patterns for dialogs, alerts, and forms

@import '../variables';
@import '../functions';

// =============================================================================
// Base Modal Block
// =============================================================================

.modal {
  // Modal dialog wrapper
  &__dialog {
    position: relative;
    width: auto;
    margin: 10px;
    pointer-events: none;
    
    @media (min-width: $screen-sm-min) {
      max-width: 500px;
      margin: 30px auto;
    }
    
    @media (min-width: $screen-md-min) {
      max-width: 600px;
    }
    
    // Centered modifier
    &--centered {
      display: flex;
      align-items: center;
      min-height: calc(100% - 20px);
      
      @media (min-width: $screen-sm-min) {
        min-height: calc(100% - 60px);
      }
    }
    
    // Large modifier
    &--large {
      @media (min-width: $screen-md-min) {
        max-width: 800px;
      }
    }
    
    // Small modifier
    &--small {
      @media (min-width: $screen-sm-min) {
        max-width: 300px;
      }
    }
  }
  
  // Modal content container
  &__content {
    position: relative;
    display: flex;
    flex-direction: column;
    width: 100%;
    pointer-events: auto;
    background-color: $white;
    background-clip: padding-box;
    border: none;
    border-radius: $border-radius-lg;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
    outline: 0;
  }
  
  // Modal header
  &__header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: $spacing-lg;
    border-bottom: 1px solid $gray-200;
    border-top-left-radius: $border-radius-lg;
    border-top-right-radius: $border-radius-lg;
    
    // Branded header modifier
    &--branded {
      background: linear-gradient(135deg, lighten($primary, 10%) 0%, $primary 100%);
      color: $white;
      border-bottom: none;
      
      .modal__title {
        color: $white;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
      }
      
      .modal__close {
        color: $white;
        opacity: 0.8;
        
        &:hover {
          opacity: 1;
        }
      }
    }
  }
  
  // Modal title
  &__title {
    margin: 0;
    line-height: 1.5;
    font-size: 22px;
    font-weight: $font-weight-bold;
    color: $gray-900;
    display: flex;
    align-items: center;
    gap: $spacing-sm;
    letter-spacing: 0.3px;
  }
  
  // Modal close button
  &__close {
    padding: 0;
    background: transparent;
    border: 0;
    font-size: 28px;
    font-weight: 300;
    line-height: 1;
    color: $gray-700;
    opacity: 0.5;
    cursor: pointer;
    transition: opacity 0.2s ease;
    
    &:hover {
      opacity: 0.75;
    }
    
    &:focus {
      outline: none;
    }
  }
  
  // Modal body
  &__body {
    position: relative;
    flex: 1 1 auto;
    padding: $spacing-xl;
    
    // Centered content modifier
    &--centered {
      text-align: center;
    }
  }
  
  // Modal footer
  &__footer {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    padding: $spacing-lg;
    border-top: 1px solid $gray-200;
    border-bottom-right-radius: $border-radius-lg;
    border-bottom-left-radius: $border-radius-lg;
    gap: $spacing-sm;
    
    // Centered modifier
    &--centered {
      justify-content: center;
    }
    
    // Spread modifier
    &--spread {
      justify-content: space-between;
    }
  }
  
  // Animation states
  &.fade &__dialog {
    transition: transform 0.3s ease-out;
    transform: scale(0.9);
  }
  
  &.show &__dialog {
    transform: scale(1);
  }
}

// Modal backdrop
.modal-backdrop {
  position: fixed;
  top: 0;
  left: 0;
  z-index: $zindex-modal-backdrop;
  width: 100%;
  height: 100%;
  background-color: rgba($black, 0.5);
  
  // Branded backdrop
  &--branded {
    background-color: rgba($brand-deep-blue, 0.5);
  }
}

// =============================================================================
// Support Ticket Modal Specific Styles
// =============================================================================

.support-modal {
  // Icon section
  &__icon {
    margin-bottom: $spacing-lg;
    
    img {
      width: 80px;
      height: 80px;
    }
  }
  
  // Message section
  &__message {
    font-size: 16px;
    color: $gray-700;
    margin-bottom: $spacing-xl;
    line-height: 1.6;
    
    strong {
      color: $brand-deep-blue;
      font-weight: $font-weight-medium;
    }
    
    code {
      background-color: rgba($brand-light-blue, 0.1);
      color: $brand-deep-blue;
      padding: 2px 8px;
      border-radius: $border-radius-sm;
      font-size: 14px;
      font-weight: $font-weight-medium;
    }
  }
  
  // Steps section
  &__steps {
    background-color: $gray-50;
    border-radius: $border-radius-md;
    padding: $spacing-lg;
    text-align: left;
    max-width: 400px;
    margin: 0 auto;
  }
  
  // Steps heading
  &__steps-heading {
    color: $brand-deep-blue;
    font-size: 16px;
    font-weight: $font-weight-medium;
    margin-bottom: $spacing-md;
  }
  
  // Steps list
  &__steps-list {
    margin-bottom: 0;
    padding-left: $spacing-lg;
    
    li {
      color: $gray-700;
      margin-bottom: $spacing-sm;
      line-height: 1.6;
      
      &:last-child {
        margin-bottom: 0;
      }
      
      code {
        background-color: $white;
        color: $brand-medium-blue;
        padding: 1px 6px;
        border-radius: $border-radius-xs;
        font-size: 13px;
        font-weight: $font-weight-medium;
      }
    }
  }
}

// =============================================================================
// Modal Icon Styles
// =============================================================================

.modal-icon {
  font-size: 20px;
  opacity: 0.9;
  
  &--white {
    color: $white;
  }
  
  &--primary {
    color: $primary;
  }
  
  &--success {
    color: $success;
  }
  
  &--warning {
    color: $warning;
  }
  
  &--danger {
    color: $danger;
  }
}

// =============================================================================
// Legacy Support (temporary during migration)
// =============================================================================

// Support ticket modal
.support-ticket-modal {
  @extend .modal__content;
  
  .modal-header {
    @extend .modal__header;
    @extend .modal__header--branded;
    
    .modal-title {
      @extend .modal__title;
      
      .glyphicon {
        @extend .modal-icon;
        @extend .modal-icon--white;
      }
    }
    
    .close {
      @extend .modal__close;
    }
  }
  
  .modal-body {
    @extend .modal__body;
    @extend .modal__body--centered;
    
    .support-ticket-icon {
      @extend .support-modal__icon;
    }
    
    .support-ticket-message {
      @extend .support-modal__message;
    }
    
    .support-ticket-steps {
      @extend .support-modal__steps;
      
      h5 {
        @extend .support-modal__steps-heading;
      }
      
      ol {
        @extend .support-modal__steps-list;
      }
    }
  }
  
  .modal-footer {
    @extend .modal__footer;
  }
}

// Modal dialog
.modal-dialog-centered {
  @extend .modal__dialog--centered;
}

// Legacy backdrop support
.modal-backdrop:not(.modal-backdrop--branded) {
  @if & {
    background-color: rgba($brand-deep-blue, 0.5);
  }
}