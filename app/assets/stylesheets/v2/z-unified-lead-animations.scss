@import 'variables';

// UNIFIED LEAD CARD ANIMATION SYSTEM
// This file overrides ALL other lead card animations to fix conflicts

// 1. DISABLE ALL CONFLICTING ANIMATIONS
// First, we need to reset everything to prevent conflicts

// Completely disable dashboard section animations and hover
#dashboard_today,
#dashboard_upcoming,
#dashboard_my_leads,
#dashboard_waitlist,
.dashboard-section {
  transition: none !important; // No transitions at all
  
  &:hover {
    transform: none !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05) !important; // Keep original shadow
    border-color: rgba($gray-200, 0.5) !important; // Keep original border
    
    &::before {
      transform: translate(50%, -50%) !important; // Keep original position
    }
  }
  
  // Also disable the background pattern animation
  &::before {
    transition: none !important;
  }
  
  // Disable all animations on dashboard headers
  h3 {
    transition: none !important;
    
    // Disable shimmer animation on underline
    &::after {
      animation: none !important;
      background-position: 0 0 !important;
    }
    
    // Disable icon animations
    .glyphicon {
      transition: none !important;
      
      &::before {
        transition: none !important;
        animation: none !important;
      }
    }
    
    &:hover .glyphicon {
      transform: none !important;
      box-shadow: 0 2px 6px rgba($brand-teal, 0.3) !important; // Keep original shadow
    }
  }
}

// Disable table row hover effects completely
.lead_listing {
  tbody tr {
    position: relative;
    z-index: auto !important;
    transition: none !important;
    transform: none !important;
    
    &:hover {
      z-index: auto !important;
      transform: none !important;
      background: transparent !important;
      
      // Don't apply any transforms to children from tr
      * {
        // Let children handle their own animations
      }
    }
  }
}

// 2. CLEAN LEAD CARD BASE STATE
.lead_card {
  // Reset all properties to known state
  position: relative !important;
  z-index: 1 !important;
  transform: translateZ(0) !important; // Force GPU acceleration
  transform-style: preserve-3d !important;
  backface-visibility: hidden !important; // Prevent flicker
  
  // Faster transition with no delay for immediate response
  transition: 
    transform 0.15s ease-out,
    box-shadow 0.15s ease-out,
    border-color 0.15s ease-out !important;
  transition-delay: 0ms !important;
  
  // Base visual state - make cards stand out more
  background: $white !important;
  border: 1px solid rgba($gray-200, 0.8) !important; // Subtle border all around
  border-left: 3px solid $brand-teal !important; // Thin accent border
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08) !important; // Stronger shadow
  border-radius: $border-radius-md !important;
  
  // Ensure no other properties interfere
  will-change: transform, box-shadow !important;
  contain: none !important;
  isolation: auto !important;
  overflow: visible !important;
  
  // Remove any ::before/::after that might interfere
  &::before,
  &::after {
    display: none !important;
  }
}

// 3. SINGLE, CLEAN HOVER STATE
.lead_card:hover {
  // Simple, predictable hover - immediate response
  transform: translateY(-4px) translateZ(0) !important;
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1) !important;
  z-index: 10 !important;
  
  // Enhanced hover state
  background: $white !important;
  border: 1px solid rgba($brand-light-blue, 0.3) !important;
  border-left-width: 3px !important; // Keep same width as base state
  border-left-style: solid !important;
  border-left-color: darken($brand-teal, 10%) !important; // Just darken the color
  
  // Fast transition for immediate response
  transition: 
    transform 0.15s ease-out,
    box-shadow 0.15s ease-out,
    border-color 0.15s ease-out !important;
  transition-delay: 0ms !important;
}

// 4. ENSURE PROPER STACKING CONTEXT
.lead_listing {
  position: relative;
  z-index: 1;
  
  // Give each row its own stacking context
  tbody tr {
    position: relative;
    z-index: 1;
    
    // When hovering a row, boost its stacking order
    &:hover {
      z-index: 2 !important; // Just enough to be above siblings
    }
  }
  
  // Ensure adequate spacing for shadows
  border-spacing: 0 16px !important; // Enough space for lifted cards
}

// 5. DISABLE PERSON ICON ANIMATIONS (they're hidden anyway)
.glyphicon-user,
.glyphicon-person {
  transition: none !important;
  transform: none !important;
  
  &:hover {
    transform: none !important;
  }
}

// 6. DISABLE CONFLICTING ANIMATIONS FROM OTHER FILES
// Override animations.scss fade-in effects
body:not(.turbolinks-loaded) {
  .lead_card {
    animation: none !important; // Disable fade-in that might conflict
    opacity: 1 !important;
  }
  
  // Also disable dashboard section fade-ins
  #dashboard_today,
  #dashboard_upcoming,
  #dashboard_my_leads,
  #dashboard_waitlist {
    animation: none !important;
    opacity: 1 !important;
  }
}

// Override home.scss complex hover to prevent border width changes
#dashboard_today .lead_card,
#dashboard_upcoming .lead_card,
#dashboard_my_leads .lead_card,
#dashboard_waitlist .lead_card,
.lead_card {
  &:hover {
    border-left-width: 3px !important; // Keep consistent 3px width
    border-left-style: solid !important;
    border-left-color: darken($brand-teal, 10%) !important;
  }
}

// 7. MOBILE - DISABLE HOVER ANIMATIONS
@media (max-width: 767px) {
  .lead_card {
    transition: none !important;
    
    &:hover {
      transform: none !important;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08) !important; // Keep base shadow
      z-index: 1 !important; // No z-index change
    }
  }
}

// 8. ENSURE SMOOTH MOUSE MOVEMENT BETWEEN CARDS
// Add a small delay to prevent flickering when moving between cards
.lead_card {
  transition-delay: 0ms !important; // Instant response
  
  &:hover {
    transition-delay: 0ms !important; // No delay on hover
  }
}

// 9. FIX CARD CONTAINER OVERFLOW
.dashboard-section {
  position: relative;
  overflow: visible !important; // Allow shadows to show
  z-index: 1;
  padding-bottom: 20px !important; // Extra space for lifted cards
}

// 10. DEBUG - Add visual indicator to see what's hovering
// Uncomment to debug hover states
// .lead_card:hover {
//   outline: 2px solid red !important;
// }
// .lead_listing tbody tr:hover {
//   outline: 2px solid blue !important;
// }