<div class="container" id="lead_<%= @lead.id %>">
  <div class="Lead" >
    <div class="priority">
      <ul>
        <li>
          <strong>Priority:</strong>
          &nbsp;
          <span><%= @lead.priority %></span>
        </li>
        <li>
          <strong>State:</strong>
          &nbsp;
          <span><%= @lead.state %></span>
        </li>
        <li>
          <strong>Agent:</strong>
          &nbsp;
          <span><%= @lead.user ? @lead.user.name : "None" %></span>
        </li>
        <li>
          <strong>FC:</strong>
          &nbsp;
          <span><%= short_datetime(@lead.first_comm) %></span>
        </li>
        <li>
          <strong>LC:</strong>
          &nbsp;
          <span><%= short_datetime(@lead.last_comm) %></span>
        </li>
      </ul>
    </div>

    <div class="controls row">
      <div class="col-md-10">
          <%= render partial: "state_toggle", locals: {lead: @lead} %>
      </div>
      <div class="col-md-2">

      </div>
    </div>

    <div class="contact" >
      <span class="lead_name">
        <%= @lead.name %> <%= @lead.is_lead? ? '' : "(Not a Lead: #{@lead.classification&.capitalize})" %>
      </span><br/>
      <span class="contact_info" >
        <span title="Primary Phone" class="glyphicon glyphicon-earphone" ></span>&nbsp;
        <%= @lead.phone1 %><br/>
        <span title="Secondary Phone" class="glyphicon glyphicon-earphone"></span>&nbsp;
        <%= @lead.phone2 %><br/>
        <span title="Email Address" class="glyphicon glyphicon-envelope"></span>&nbsp;
        <% if @lead.email.present? %>
          <%= @lead.email %>
        <% else %>
          <span class="missing_lead_email">Email Required</span>
        <% end %><br/>
        <span title="Fax Number" class="glyphicon glyphicon-file"></span>&nbsp;
        <%= @lead.fax %>
      </span>
    </div>
    <div class="property">
      <% if @lead.property.present? %>
        <span>
          <span class="glyphicon glyphicon-home"></span>&nbsp;
          <%= @lead.property.name %>
        </span><br/>
        <span>
          <span class="glyphicon glyphicon-filter"></span>&nbsp;
          <%= @lead.source.name %>
        </span><br/>
      <% else %>
        <span>No Property<br/></span>
      <% end %>
      <span>
        <span class="glyphicon glyphicon-user"></span>&nbsp;
        <%= @lead.referral %>
      </span>
      <span>
        <em>Yardi ID:</em> <%= @lead.remoteid || 'None' %>
      </span>
    </div>
    <div class="preferences">
      <span>
        <strong>Move-In: </strong>
        <%= long_date(@lead.preference.move_in) %>
      </span><br/>
      <span>
        <strong>Price: </strong>
        $<%= @lead.preference.min_price %> - $<%= @lead.preference.max_price %>
    </span><br/>
    <span>
      <strong>Unit Size: </strong>
      <%= @lead.preference.min_area %> - <%= @lead.preference.max_area %>
    </span><br/>
    <span>
      <strong>Unit Type: </strong>
      <%= @lead.preference.unit_type.try(:name) %>
    </span><br/>
  </div>
  <div class="notes">
    <p class="lead_notes">
      <strong>Lead Notes: </strong>
      <span>
        <%= @lead.preference.notes %>
      </span>
    </p>
    <p class="lead_notes">
      <strong>Agent Notes: </strong>
      <span>
        <%= @lead.notes %>
      </span>
    </p>
    <% if @lead.optout? %>
      <h3>This lead has opted out of automatic notifications.</h3>
    <% end %>
  </div>

  <%= render partial: 'scheduled_actions', locals: {lead: @lead} %>
  <%= render partial: 'comments', locals: {lead: @lead} %>
  <%= render partial: 'messages', locals: {lead: @lead} %>
  <%= render partial: 'calls', locals: {lead: @lead} %>

</div>
  <div class="row">
    <div class="col-md-12">
      <%= link_to 'Edit Lead', edit_lead_path(@lead), class: "btn btn-xs btn-primary" %>
      <%= link_to 'Back', :back, class: "btn btn-xs btn-info" %>
    </div>
  </div>
</div>
