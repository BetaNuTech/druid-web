<div class="tasks-section" id="scheduled_actions">
  <div class="section-header">
    <h2><%= glyph(:check) %> Tasks</h2>
    <div class="header-actions">
      <%= link_to new_scheduled_action_path(scheduled_action: {target_id: lead.id, target_type: 'Lead'}), class: 'btn btn-primary' do %>
        <%= glyph(:plus) %> Schedule a Task
      <% end %>
      <%= link_to '#', id: 'lead_task_toggle_completed', class: 'btn btn-secondary' do %>
        <span class="toggle-text">Show Completed</span>
      <% end %>
    </div>
  </div>
  <div class="tasks-container">
    <% if lead.scheduled_actions.incomplete.empty? %>
      <div class="empty-tasks">
        <span class="empty-icon"><%= glyph(:ok) %></span>
        <p>No pending tasks</p>
        <p class="text-muted">All tasks have been completed</p>
      </div>
    <% else %>
      <div class="tasks-list pending-tasks">
        <%= render collection: lead.scheduled_actions.incomplete.sorted_by_due_asc, partial: 'scheduled_action' %>
      </div>
    <% end %>
    
    <div class="tasks-list completed-tasks" style="display: none;">
      <% if lead.scheduled_actions.complete.any? %>
        <%= render collection: lead.scheduled_actions.complete.sorted_by_due_asc, partial: 'scheduled_action' %>
      <% else %>
        <div class="empty-tasks">
          <span class="empty-icon"><%= glyph(:inbox) %></span>
          <p>No completed tasks</p>
        </div>
      <% end %>
    </div>
  </div>
</div>
