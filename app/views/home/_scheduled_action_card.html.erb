<div class="task-card task-<%= task_type %>" data-task-url="<%= completion_form_scheduled_action_path(scheduled_action_card) %>" style="cursor: pointer;">
  <div class="task-card-content">
    <div class="task-icon task-icon-<%= scheduled_action_card.lead_action.try(:glyph) || 'document' %>">
      <%= glyph(scheduled_action_card.lead_action.try(:glyph) || :list_alt) %>
    </div>
    
    <div class="task-details">
      <div class="task-time">
        <%= glyph(:time) %>
        <%= short_datetime(scheduled_action_card.schedule.to_datetime) %>
      </div>
      
      <div class="task-title">
        <%= link_to(completion_form_scheduled_action_path(scheduled_action_card)) do %>
          <%= action_and_reason(scheduled_action_card) %>
        <% end %>
      </div>
      
      <% if scheduled_action_card.description.present? %>
        <div class="task-description">
          <%= scheduled_action_card.description %>
          <% unless scheduled_action_card.target == current_user %>
            <span class="task-target">
              for <%= link_to(scheduled_action_card.target.name, url_for(scheduled_action_card.target)) rescue '' %>
            </span>
          <% end %>
        </div>
      <% end %>
    </div>
    
    <div class="task-actions" style="opacity: 1;">
      <% if policy(scheduled_action_card).complete? %>
        <%= link_to(complete_scheduled_action_path({ id: scheduled_action_card.id, event: 'complete', message: 'Quick complete task from dashboard', return: true }), 
                    method: :post, 
                    class: 'btn-task-action btn-complete',
                    title: 'Complete Task',
                    data: { toggle: 'tooltip', placement: 'top' }) do %>
          <%= glyph(:check) %>
        <% end %>
      <% end %>
      
      <% if policy(scheduled_action_card).edit? %>
        <%= link_to(edit_scheduled_action_path(scheduled_action_card), 
                    class: 'btn-task-action btn-edit',
                    title: 'Edit Task',
                    data: { toggle: 'tooltip', placement: 'top' }) do %>
          <%= glyph(:edit) %>
        <% end %>
      <% end %>
      
      <% if policy(scheduled_action_card).complete? %>
        <%= link_to(complete_scheduled_action_path({ id: scheduled_action_card.id, event: 'reject', message: 'Quick reject task from dashboard', return: true }), 
                    method: :post, 
                    class: 'btn-task-action btn-reject',
                    title: 'Reject Task',
                    data: { toggle: 'tooltip', placement: 'top', confirm: 'Are you sure you want to reject this task?' }) do %>
          <%= glyph(:trash) %>
        <% end %>
      <% end %>
    </div>
  </div>
</div>